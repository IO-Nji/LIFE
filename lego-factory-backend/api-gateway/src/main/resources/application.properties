# Import .env file from parent directory
spring.config.import=optional:file:../.env[.properties]

spring.application.name=${APP_NAME:lego-sample-factory}-api-gateway
server.port=${API_GATEWAY_PORT:8011}

# Service Discovery (Disabled for development)
eureka.client.enabled=${EUREKA_CLIENT_ENABLED:false}
spring.cloud.discovery.enabled=${SPRING_CLOUD_DISCOVERY_ENABLED:false}

# JWT Configuration
security.jwt.secret=${JWT_SECRET:MySecretKeyForJWTTokenGeneration2024AtLeast32Characters}
security.jwt.expiration=${JWT_EXPIRATION:PT1H}

# Service Routes
spring.cloud.gateway.routes[0].id=user-service
spring.cloud.gateway.routes[0].uri=http://localhost:${USER_SERVICE_PORT:8012}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/users/**

spring.cloud.gateway.routes[1].id=masterdata-service
spring.cloud.gateway.routes[1].uri=http://localhost:${MASTERDATA_SERVICE_PORT:8013}
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/masterdata/**

spring.cloud.gateway.routes[2].id=inventory-service
spring.cloud.gateway.routes[2].uri=http://localhost:${INVENTORY_SERVICE_PORT:8014}
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/inventory/**

spring.cloud.gateway.routes[3].id=order-processing-service
spring.cloud.gateway.routes[3].uri=http://localhost:${ORDER_PROCESSING_SERVICE_PORT:8015}
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/orders/**,/api/assembly/**

# Enhanced CORS Configuration
spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping=true
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOrigins=${API_GATEWAY_CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:80,http://localhost,http://localhost:5173}
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true

# Actuator Configuration
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE:health,info,metrics}
management.endpoint.health.show-details=${MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS:always}

# Logging Configuration
logging.level.org.springframework.cloud.gateway=${API_GATEWAY_DEBUG_LOGGING_LEVEL:INFO}
logging.level.io.life=${LOGGING_LEVEL_IO_LIFE:DEBUG}
logging.level.root=${LOG_LEVEL_ROOT:INFO}

# Environment Profile
spring.profiles.active=${SPRING_PROFILES_ACTIVE:development}