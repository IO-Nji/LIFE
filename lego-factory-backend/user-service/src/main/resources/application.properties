# Import .env file from parent directory
spring.config.import=optional:file:../.env[.properties]

spring.application.name=${APP_NAME:lego-sample-factory}-user-service
server.port=${USER_SERVICE_PORT:8012}

# H2 Database Configuration (Development)
spring.datasource.url=${H2_DB_USER_PATH:jdbc:h2:mem:lego_factory_auth;MODE=PostgreSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# Database Connection Pooling
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.maximum-pool-size=${DB_CONNECTION_POOL_SIZE:10}
spring.datasource.hikari.connection-timeout=${DB_CONNECTION_TIMEOUT:20000}
spring.datasource.hikari.idle-timeout=${DB_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${DB_MAX_LIFETIME:1800000}

# H2 Console Configuration
spring.h2.console.enabled=${SPRING_H2_CONSOLE_ENABLED:true}
spring.h2.console.path=${SPRING_H2_CONSOLE_PATH:/h2-console}

# JPA Configuration
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:create-drop}
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:true}

# JWT Configuration
security.jwt.secret=${JWT_SECRET:MySecretKeyForJWTTokenGeneration2024AtLeast32Characters}
security.jwt.expiration=${JWT_EXPIRATION:PT1H}

# Security Configuration
security.bcrypt.strength=${BCRYPT_STRENGTH:10}
security.session.timeout=${SESSION_TIMEOUT:PT30M}
security.login.max-attempts=${MAX_LOGIN_ATTEMPTS:5}
security.login.lockout-duration=${LOCKOUT_DURATION:PT15M}

# Actuator Configuration - Allow detailed health info
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE:health,info,metrics}
management.endpoint.health.show-details=${MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS:always}
management.health.db.enabled=true
management.security.enabled=false

# Allow access to root health endpoint
management.server.port=${USER_SERVICE_PORT:8012}

# Allow CORS for health endpoints
management.endpoints.web.cors.allowed-origins=${API_GATEWAY_CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:80,http://localhost,http://localhost:5173}
management.endpoints.web.cors.allowed-methods=GET,POST,OPTIONS
management.endpoints.web.cors.allowed-headers=*
management.endpoints.web.cors.allow-credentials=true

# Logging Configuration
logging.level.io.life=${LOGGING_LEVEL_IO_LIFE:DEBUG}
logging.level.org.springframework.security=${LOG_LEVEL_SPRING:INFO}
logging.level.org.hibernate=${LOG_LEVEL_HIBERNATE:WARN}
logging.level.root=${LOG_LEVEL_ROOT:INFO}

# Service Discovery (Disabled for development)
eureka.client.enabled=${EUREKA_CLIENT_ENABLED:false}
spring.cloud.discovery.enabled=${SPRING_CLOUD_DISCOVERY_ENABLED:false}

# Environment Profile
spring.profiles.active=${SPRING_PROFILES_ACTIVE:development}